"
" Copied over from .vimrc
"

" To have most of the same defaults as neovim
" Can't remap `Y` as it's used incredibly often and needs to be pressed reliably
"nnoremap Y y$
nnoremap <C-L> <Cmd>nohlsearch<Bar>diffupdate<Bar>normal! <C-L><CR>
inoremap <C-U> <C-G>u<C-U>
inoremap <C-W> <C-G>u<C-W>
xnoremap * y/\V<C-R>"<CR>
xnoremap # y?\V<C-R>"<CR>
nnoremap & :&&<CR>

" Quotes with backticks (useful for Markdown-style code words)
" Like using vim-surround with ysiw`
" NOTE: in some contexts IntelliJ will add matching backtick, so we only insert one
nnoremap <Leader>` ciw`<C-R>-`<Esc>


"
" Enable emulated plugins
"

packadd matchit

Plug 'tpope/vim-surround'
Plug 'tpope/vim-commentary'
Plug 'vim-scripts/ReplaceWithRegister'
Plug 'tommcdo/vim-exchange'
Plug 'vim-scripts/argtextobj.vim'
Plug 'michaeljsmith/vim-indent-object'
Plug 'kana/vim-textobj-entire'
Plug 'machakann/vim-highlightedyank'

Plug 'easymotion/vim-easymotion'
" To emulate vim-sneak.
" NOTE: This is better than the way vim-easymotion emulates vim-sneak because
"   you can keep typing characters.
nmap - <Plug>(easymotion-s2)

Plug 'terryma/vim-multiple-cursors'
" These mappings are to match vim-surround in vim and because of conflict with the Mac
"   option key which prints out unicode chars.
"   Unfortunately,$ we lose the ability to do ^N and ^P in insert mode for cyclical word search
"   (which we would assign to IDE in "Vim Emulation" settings)
map <C-N> <A-N>
map <C-P> <A-P>
map <C-X> <A-X>
map g<C-N> g<A-N>

"
" Enable IdeaVim-specific features
"

" https://github.com/JetBrains/ideavim/wiki/%60ideajoin%60-examples
" TODO: wait until it matures; doesn't work except for maybe `comments`.
"   I think it's designed for Java and Kotlin
"set ideajoin

"
" Key mappings
"

" To emulate CamelCaseMotion
map ,w [w
map ,e ]w
map ,b [b
map ,ge ]b

" For formatting, especially comments
" Depends on https://plugins.jetbrains.com/plugin/7234-wrap-to-column/
vnoremap gq :action com.andrewbrookins.idea.wrap.WrapAction<CR>

" Enable relative numbers
" source: https://youtrack.jetbrains.com/issue/VIM-410
set number relativenumber
augroup numbertoggle
    autocmd!
    autocmd BufEnter,FocusGained,InsertLeave * set number relativenumber
    autocmd BufLeave,FocusLost,InsertEnter   * set nonumber norelativenumber
augroup END
